{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\nexports.shallowEqual = shallowEqual;\nexports['default'] = pure;\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\nvar _tcomb = require('tcomb');\nvar _tcomb2 = _interopRequireDefault(_tcomb);\nvar _isReactComponent = require('../isReactComponent');\nvar _isReactComponent2 = _interopRequireDefault(_isReactComponent);\nvar _debug = require('debug');\nvar _debug2 = _interopRequireDefault(_debug);\nvar log = _debug2['default']('revenge:@pure');\n\n// export for tests\n\nfunction shallowEqual(objA, objB, section, component) {\n  if (objA === objB) {\n    return true;\n  }\n  var displayName = component.constructor.name;\n  var rootNodeID = (component._reactInternalInstance || {})._rootNodeID;\n  if (!objA || typeof objA !== 'object') {\n    // the opposite should never happen here, since we are using this as\n    // `shallowEqual(prevProps, nextProps)` or `shallowEqual(prevState, nextState)`\n    if (process.env.NODE_ENV !== 'production') {\n      log('component ' + displayName + ' with rootNodeID ' + rootNodeID + ' will re-render since object has no previous value');\n    }\n    return false;\n  }\n  var key = undefined;\n  // Test for A's keys different from B.\n  for (key in objA) {\n    if (objA.hasOwnProperty(key) && (!objB.hasOwnProperty(key) || objA[key] !== objB[key])) {\n      if (process.env.NODE_ENV !== 'production') {\n        log('component ' + displayName + ' with rootNodeID ' + rootNodeID + ' will re-render since ' + section + ' key ' + key + ' is changed from ', objA[key], ' to ', objB[key]);\n      }\n      return false;\n    }\n  }\n  // Test for B's keys missing from A.\n  for (key in objB) {\n    if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {\n      if (process.env.NODE_ENV !== 'production') {\n        log('component ' + displayName + ' with rootNodeID ' + rootNodeID + ' will re-render since ' + section + ' key ' + key + ' with value ', objB[key], 'is new');\n      }\n      return false;\n    }\n  }\n  return true;\n}\nfunction pure(Component) {\n  if (process.env.NODE_ENV !== 'production') {\n    _tcomb2['default'].assert(_isReactComponent2['default'](Component), '@pure decorator can only be applied to React.Component(s)');\n  }\n  var originalScu = Component.prototype.shouldComponentUpdate;\n  Component.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n    var _this = this;\n    var _scu = function _scu() {\n      return !shallowEqual(_this.props, nextProps, 'props', _this) || !shallowEqual(_this.state, nextState, 'state', _this);\n    };\n    return originalScu ? originalScu(nextProps, nextState, _scu) : _scu();\n  };\n}","map":null,"metadata":{},"sourceType":"script"}