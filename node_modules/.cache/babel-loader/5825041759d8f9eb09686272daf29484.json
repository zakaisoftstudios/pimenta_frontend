{"ast":null,"code":"import _toConsumableArray from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { debug } from 'util';\nvar CheckboxHasManyContainer = /*#__PURE__*/function (_React$Component) {\n  _inherits(CheckboxHasManyContainer, _React$Component);\n  var _super = _createSuper(CheckboxHasManyContainer);\n  function CheckboxHasManyContainer() {\n    var _this;\n    _classCallCheck(this, CheckboxHasManyContainer);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      options: [],\n      selectedOptionsIds: []\n    };\n    _this.normalizeOptionsIds = function () {\n      return _this.props.options.map(function (option) {\n        return {\n          label: option.label,\n          id: option.id.toString()\n        };\n      });\n    };\n    _this.initialValuesOptionIds = function () {\n      var _this$props = _this.props,\n        initialValues = _this$props.initialValues,\n        optionItemName = _this$props.optionItemName;\n      return initialValues.map(function (value) {\n        return value[optionItemName].id.toString();\n      });\n    };\n    _this.isChecked = function (id) {\n      return _this.state.selectedOptionsIds.includes(id);\n    };\n    _this.updateFormValue = function () {\n      var _this$props2 = _this.props,\n        setFieldValue = _this$props2.setFieldValue,\n        fieldName = _this$props2.fieldName,\n        optionItemName = _this$props2.optionItemName,\n        initialValues = _this$props2.initialValues,\n        ownerId = _this$props2.ownerId,\n        ownerName = _this$props2.ownerName,\n        additionalFields = _this$props2.additionalFields;\n      var selectedOptionsIds = _this.state.selectedOptionsIds;\n      var toDestroy = initialValues.filter(function (initialValue) {\n        return !selectedOptionsIds.includes(initialValue[optionItemName].id.toString());\n      }).map(function (toDestroy) {\n        return _objectSpread({\n          id: toDestroy.id,\n          _destroy: true\n        }, additionalFields);\n      });\n      var toDestroyIds = toDestroy.map(function (toDestroy) {\n        return toDestroy.id;\n      });\n      var toKeep = initialValues.filter(function (initialValue) {\n        return !toDestroyIds.includes(initialValue.id);\n      });\n      var toAdd = selectedOptionsIds.filter(function (selectedOptionId) {\n        return !_this.initialValuesOptionIds().includes(selectedOptionId);\n      }).map(function (selectedOptionId) {\n        var _objectSpread2;\n        return _objectSpread((_objectSpread2 = {}, _defineProperty(_objectSpread2, \"\".concat(optionItemName, \"_id\"), selectedOptionId), _defineProperty(_objectSpread2, \"\".concat(ownerName, \"_id\"), ownerId), _objectSpread2), additionalFields);\n      });\n      setFieldValue(fieldName, [].concat(_toConsumableArray(toDestroy), _toConsumableArray(toAdd), _toConsumableArray(toKeep)));\n    };\n    _this.handleCheckboxChange = function (event) {\n      var selectedOptionsIds = _this.state.selectedOptionsIds;\n      var _this$props3 = _this.props,\n        limit = _this$props3.limit,\n        setFieldTouched = _this$props3.setFieldTouched,\n        fieldName = _this$props3.fieldName;\n      setFieldTouched(fieldName);\n      if (limit && event.target.checked && selectedOptionsIds.length >= limit) {\n        event.preventDefault();\n        return;\n      }\n      var optionId = event.target.value;\n      var newSelectedOptionsIds = event.target.checked ? [].concat(_toConsumableArray(selectedOptionsIds), [optionId]) : _toConsumableArray(selectedOptionsIds.filter(function (id) {\n        return id !== optionId;\n      }));\n      _this.setState(function () {\n        return {\n          selectedOptionsIds: newSelectedOptionsIds\n        };\n      }, function () {\n        return _this.updateFormValue();\n      });\n    };\n    _this.getSelectedItemsAsString = function (itemToString) {\n      return _this.state.options.filter(function (option) {\n        return _this.state.selectedOptionsIds.includes(option.id);\n      }).map(function (option) {\n        return itemToString(option);\n      }).join(', ');\n    };\n    return _this;\n  }\n  _createClass(CheckboxHasManyContainer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setState({\n        selectedOptionsIds: this.initialValuesOptionIds(),\n        options: this.normalizeOptionsIds()\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n        selectedOptionsIds = _this$state.selectedOptionsIds,\n        options = _this$state.options;\n      var props = {\n        options: options,\n        selectedOptionsIds: selectedOptionsIds,\n        isChecked: this.isChecked,\n        handleChange: this.handleCheckboxChange,\n        getSelectedItemsAsString: this.getSelectedItemsAsString\n      };\n      return this.props.render(props);\n    }\n  }]);\n  return CheckboxHasManyContainer;\n}(React.Component);\nCheckboxHasManyContainer.propTypes = {\n  options: PropTypes.array.isRequired,\n  initialValues: PropTypes.array.isRequired,\n  optionItemName: PropTypes.string.isRequired,\n  fieldName: PropTypes.string.isRequired,\n  ownerName: PropTypes.string.isRequired,\n  ownerId: PropTypes.number.isRequired,\n  setFieldValue: PropTypes.func.isRequired,\n  render: PropTypes.func.isRequired\n};\nexport default CheckboxHasManyContainer;","map":{"version":3,"names":["React","PropTypes","debug","CheckboxHasManyContainer","state","options","selectedOptionsIds","normalizeOptionsIds","props","map","option","label","id","toString","initialValuesOptionIds","initialValues","optionItemName","value","isChecked","includes","updateFormValue","setFieldValue","fieldName","ownerId","ownerName","additionalFields","toDestroy","filter","initialValue","_destroy","toDestroyIds","toKeep","toAdd","selectedOptionId","handleCheckboxChange","event","limit","setFieldTouched","target","checked","length","preventDefault","optionId","newSelectedOptionsIds","setState","getSelectedItemsAsString","itemToString","join","handleChange","render","Component","propTypes","array","isRequired","string","number","func"],"sources":["/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/src/containers/Shared/CheckboxHasManyContainer.js"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { debug } from 'util'\n\nclass CheckboxHasManyContainer extends React.Component {\n  state = {\n    options: [],\n    selectedOptionsIds: []\n  }\n\n  componentDidMount() {\n    this.setState({\n      selectedOptionsIds: this.initialValuesOptionIds(),\n      options: this.normalizeOptionsIds()\n    })\n  }\n\n  normalizeOptionsIds = () =>\n    this.props.options.map(option => ({\n      label: option.label,\n      id: option.id.toString()\n    }))\n\n  initialValuesOptionIds = () => {\n    const { initialValues, optionItemName } = this.props\n    return initialValues.map(value => value[optionItemName].id.toString())\n  }\n\n  isChecked = id => this.state.selectedOptionsIds.includes(id)\n\n  updateFormValue = () => {\n    const {\n      setFieldValue,\n      fieldName,\n      optionItemName,\n      initialValues,\n      ownerId,\n      ownerName,\n      additionalFields\n    } = this.props\n\n    const { selectedOptionsIds } = this.state\n\n    const toDestroy = initialValues\n      .filter(\n        initialValue =>\n          !selectedOptionsIds.includes(\n            initialValue[optionItemName].id.toString()\n          )\n      )\n      .map(toDestroy => ({\n        id: toDestroy.id,\n        _destroy: true,\n        ...additionalFields\n      }))\n\n    const toDestroyIds = toDestroy.map(toDestroy => toDestroy.id)\n    const toKeep = initialValues.filter(\n      initialValue => !toDestroyIds.includes(initialValue.id)\n    )\n\n    const toAdd = selectedOptionsIds\n      .filter(\n        selectedOptionId =>\n          !this.initialValuesOptionIds().includes(selectedOptionId)\n      )\n      .map(selectedOptionId => ({\n        [`${optionItemName}_id`]: selectedOptionId,\n        [`${ownerName}_id`]: ownerId,\n        ...additionalFields\n      }))\n\n    setFieldValue(fieldName, [...toDestroy, ...toAdd, ...toKeep])\n  }\n\n  handleCheckboxChange = event => {\n    const { selectedOptionsIds } = this.state\n    const { limit, setFieldTouched, fieldName } = this.props\n\n    setFieldTouched(fieldName)\n\n    if (limit && event.target.checked && selectedOptionsIds.length >= limit) {\n      event.preventDefault()\n      return\n    }\n\n    const optionId = event.target.value\n\n    const newSelectedOptionsIds = event.target.checked\n      ? [...selectedOptionsIds, optionId]\n      : [...selectedOptionsIds.filter(id => id !== optionId)]\n\n    this.setState(\n      () => ({\n        selectedOptionsIds: newSelectedOptionsIds\n      }),\n      () => this.updateFormValue()\n    )\n  }\n\n  getSelectedItemsAsString = itemToString =>\n    this.state.options\n      .filter(option => this.state.selectedOptionsIds.includes(option.id))\n      .map(option => itemToString(option))\n      .join(', ')\n\n  render() {\n    const { selectedOptionsIds, options } = this.state\n\n    const props = {\n      options,\n      selectedOptionsIds,\n      isChecked: this.isChecked,\n      handleChange: this.handleCheckboxChange,\n      getSelectedItemsAsString: this.getSelectedItemsAsString\n    }\n\n    return this.props.render(props)\n  }\n}\n\nCheckboxHasManyContainer.propTypes = {\n  options: PropTypes.array.isRequired,\n  initialValues: PropTypes.array.isRequired,\n  optionItemName: PropTypes.string.isRequired,\n  fieldName: PropTypes.string.isRequired,\n  ownerName: PropTypes.string.isRequired,\n  ownerId: PropTypes.number.isRequired,\n  setFieldValue: PropTypes.func.isRequired,\n  render: PropTypes.func.isRequired\n}\n\nexport default CheckboxHasManyContainer\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}