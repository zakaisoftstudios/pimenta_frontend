{"ast":null,"code":"import _defineProperty from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _classCallCheck from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _excluded = [\"id\", \"_new\"];\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport uuid from 'uuid/v1';\nvar HasManyContainer = /*#__PURE__*/function (_React$Component) {\n  _inherits(HasManyContainer, _React$Component);\n  var _super = _createSuper(HasManyContainer);\n  function HasManyContainer() {\n    var _this;\n    _classCallCheck(this, HasManyContainer);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      items: [],\n      newItems: [],\n      showNewForm: false,\n      fieldName: ''\n    };\n    _this.updateParentForm = function (setParentFormFieldValue) {\n      var _this$state = _this.state,\n        items = _this$state.items,\n        newItems = _this$state.newItems,\n        fieldName = _this$state.fieldName;\n      var normalizedNewItems = newItems.map(function (newItem) {\n        var id = newItem.id,\n          _new = newItem._new,\n          rest = _objectWithoutProperties(newItem, _excluded);\n        return _objectSpread({}, rest);\n      });\n      var allItems = [].concat(_toConsumableArray(items), _toConsumableArray(normalizedNewItems));\n      setParentFormFieldValue(fieldName, allItems);\n    };\n    _this.handleRemoveItem = function (id, setParentFormFieldValue) {\n      return function () {\n        var items = _this.state.items;\n        var toRemove = items.find(function (item) {\n          return item.id === id;\n        });\n        var itemWithDestroy = _objectSpread(_objectSpread({}, toRemove), {}, {\n          _destroy: true\n        });\n        var unmodifiedItems = items.filter(function (item) {\n          return item.id !== id;\n        });\n        _this.setState(function () {\n          return {\n            items: [].concat(_toConsumableArray(unmodifiedItems), [itemWithDestroy])\n          };\n        }, function () {\n          return _this.updateParentForm(setParentFormFieldValue);\n        });\n      };\n    };\n    _this.handleRemoveNewItem = function (removeindex, setParentFormFieldValue) {\n      return function () {\n        var newItems = _this.state.newItems;\n        var filteredItems = newItems.filter(function (_, index) {\n          return index !== removeindex;\n        });\n        _this.setState(function () {\n          return {\n            newItems: filteredItems\n          };\n        }, function () {\n          return _this.updateParentForm(setParentFormFieldValue);\n        });\n      };\n    };\n    _this.handleAddItem = function (setParentFormFieldValue) {\n      return function (values, _ref) {\n        var resetForm = _ref.resetForm;\n        _this.state.itemToEdit ? _this.updateItem(values, setParentFormFieldValue) : _this.addItem(values, setParentFormFieldValue);\n        resetForm();\n      };\n    };\n    _this.addItem = function (values, setParentFormFieldValue) {\n      var newItem = _objectSpread(_objectSpread({}, values), {}, {\n        _new: true,\n        id: uuid()\n      });\n      var newItems = [].concat(_toConsumableArray(_this.state.newItems), [newItem]);\n      _this.setState(function () {\n        return {\n          newItems: newItems,\n          showNewForm: false\n        };\n      }, function () {\n        return _this.updateParentForm(setParentFormFieldValue);\n      });\n    };\n    _this.updateItem = function (values, setParentFormFieldValue) {\n      var originalItemsKey = values._new ? 'newItems' : 'items';\n      var unmodifiedItems = _this.state[originalItemsKey].filter(function (item) {\n        return item.id !== values.id;\n      });\n      var updatedItems = [].concat(_toConsumableArray(unmodifiedItems), [values]);\n      _this.setState(function () {\n        var _ref2;\n        return _ref2 = {}, _defineProperty(_ref2, originalItemsKey, updatedItems), _defineProperty(_ref2, \"showNewForm\", false), _defineProperty(_ref2, \"itemToEdit\", null), _ref2;\n      }, function () {\n        return _this.updateParentForm(setParentFormFieldValue);\n      });\n    };\n    _this.handleEditItem = function (itemToEdit) {\n      return function () {\n        return _this.setState({\n          itemToEdit: itemToEdit,\n          showNewForm: true\n        });\n      };\n    };\n    _this.handleClearNewForm = function (handleReset) {\n      return function () {\n        handleReset();\n        _this.setState({\n          showNewForm: false,\n          itemToEdit: null\n        });\n      };\n    };\n    _this.handleToggleNewForm = function () {\n      var showNewForm = _this.state.showNewForm;\n      _this.setState({\n        showNewForm: !showNewForm\n      });\n    };\n    _this.undestroyedItems = function () {\n      return _this.state.items.filter(function (item) {\n        return !item.hasOwnProperty('_destroy');\n      });\n    };\n    return _this;\n  }\n  _createClass(HasManyContainer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props = this.props,\n        items = _this$props.items,\n        fieldName = _this$props.fieldName;\n      this.setState({\n        items: items,\n        fieldName: fieldName\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = _objectSpread(_objectSpread({}, this.state), {}, {\n        undestroyedItems: this.undestroyedItems(),\n        handleRemoveItem: this.handleRemoveItem,\n        handleRemoveNewItem: this.handleRemoveNewItem,\n        handleAddItem: this.handleAddItem,\n        handleClearNewForm: this.handleClearNewForm,\n        handleToggleNewForm: this.handleToggleNewForm,\n        handleEditItem: this.handleEditItem\n      });\n      return this.props.render(props);\n    }\n  }]);\n  return HasManyContainer;\n}(React.Component);\nHasManyContainer.propTypes = {\n  items: PropTypes.array.isRequired,\n  fieldName: PropTypes.string.isRequired\n};\nexport default HasManyContainer;","map":{"version":3,"names":["React","PropTypes","uuid","HasManyContainer","state","items","newItems","showNewForm","fieldName","updateParentForm","setParentFormFieldValue","normalizedNewItems","map","newItem","id","_new","rest","allItems","handleRemoveItem","toRemove","find","item","itemWithDestroy","_destroy","unmodifiedItems","filter","setState","handleRemoveNewItem","removeindex","filteredItems","_","index","handleAddItem","values","resetForm","itemToEdit","updateItem","addItem","originalItemsKey","updatedItems","handleEditItem","handleClearNewForm","handleReset","handleToggleNewForm","undestroyedItems","hasOwnProperty","props","render","Component","propTypes","array","isRequired","string"],"sources":["/home/zakaisoftstudios/Desktop/railsprojects/pimenta-group/pimenta-group-nextstep_frontend_react-28a5c2a2a4fe/src/containers/Shared/HasManyContainer.js"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport uuid from 'uuid/v1'\n\nclass HasManyContainer extends React.Component {\n  state = {\n    items: [],\n    newItems: [],\n    showNewForm: false,\n    fieldName: ''\n  }\n\n  componentDidMount() {\n    const { items, fieldName } = this.props\n    this.setState({ items, fieldName })\n  }\n\n  updateParentForm = setParentFormFieldValue => {\n    const { items, newItems, fieldName } = this.state\n\n    const normalizedNewItems = newItems.map(newItem => {\n      const { id, _new, ...rest } = newItem\n      return { ...rest }\n    })\n\n    const allItems = [...items, ...normalizedNewItems]\n\n    setParentFormFieldValue(fieldName, allItems)\n  }\n\n  handleRemoveItem = (id, setParentFormFieldValue) => () => {\n    const { items } = this.state\n\n    const toRemove = items.find(item => item.id === id)\n    const itemWithDestroy = { ...toRemove, _destroy: true }\n    const unmodifiedItems = items.filter(item => item.id !== id)\n\n    this.setState(\n      () => ({\n        items: [...unmodifiedItems, itemWithDestroy]\n      }),\n      () => this.updateParentForm(setParentFormFieldValue)\n    )\n  }\n\n  handleRemoveNewItem = (removeindex, setParentFormFieldValue) => () => {\n    const { newItems } = this.state\n    const filteredItems = newItems.filter((_, index) => index !== removeindex)\n\n    this.setState(\n      () => ({ newItems: filteredItems }),\n      () => this.updateParentForm(setParentFormFieldValue)\n    )\n  }\n\n  handleAddItem = setParentFormFieldValue => (values, { resetForm }) => {\n    this.state.itemToEdit\n      ? this.updateItem(values, setParentFormFieldValue)\n      : this.addItem(values, setParentFormFieldValue)\n    resetForm()\n  }\n\n  addItem = (values, setParentFormFieldValue) => {\n    const newItem = { ...values, _new: true, id: uuid() }\n    const newItems = [...this.state.newItems, newItem]\n\n    this.setState(\n      () => ({\n        newItems,\n        showNewForm: false\n      }),\n      () => this.updateParentForm(setParentFormFieldValue)\n    )\n  }\n\n  updateItem = (values, setParentFormFieldValue) => {\n    const originalItemsKey = values._new ? 'newItems' : 'items'\n\n    const unmodifiedItems = this.state[originalItemsKey].filter(\n      item => item.id !== values.id\n    )\n\n    const updatedItems = [...unmodifiedItems, values]\n\n    this.setState(\n      () => ({\n        [originalItemsKey]: updatedItems,\n        showNewForm: false,\n        itemToEdit: null\n      }),\n      () => this.updateParentForm(setParentFormFieldValue)\n    )\n  }\n\n  handleEditItem = itemToEdit => () =>\n    this.setState({ itemToEdit, showNewForm: true })\n\n  handleClearNewForm = handleReset => () => {\n    handleReset()\n    this.setState({ showNewForm: false, itemToEdit: null })\n  }\n\n  handleToggleNewForm = () => {\n    const { showNewForm } = this.state\n\n    this.setState({\n      showNewForm: !showNewForm\n    })\n  }\n\n  undestroyedItems = () =>\n    this.state.items.filter(item => !item.hasOwnProperty('_destroy'))\n\n  render() {\n    const props = {\n      ...this.state,\n      undestroyedItems: this.undestroyedItems(),\n      handleRemoveItem: this.handleRemoveItem,\n      handleRemoveNewItem: this.handleRemoveNewItem,\n      handleAddItem: this.handleAddItem,\n      handleClearNewForm: this.handleClearNewForm,\n      handleToggleNewForm: this.handleToggleNewForm,\n      handleEditItem: this.handleEditItem\n    }\n\n    return this.props.render(props)\n  }\n}\n\nHasManyContainer.propTypes = {\n  items: PropTypes.array.isRequired,\n  fieldName: PropTypes.string.isRequired\n}\n\nexport default HasManyContainer\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}